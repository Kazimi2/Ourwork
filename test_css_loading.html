<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSS加载测试 - 鸦片战争项目</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .test-item {
            margin: 15px 0;
            padding: 15px;
            border-left: 4px solid #1e3a8a;
            background-color: white;
        }
        .success {
            color: #10b981;
            font-weight: bold;
        }
        .error {
            color: #ef4444;
            font-weight: bold;
        }
        .warning {
            color: #f59e0b;
            font-weight: bold;
        }
        .test-button {
            background-color: #1e3a8a;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .test-button:hover {
            background-color: #1e40af;
        }
        .css-preview {
            margin-top: 20px;
            padding: 15px;
            background-color: #e0e7ff;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>CSS文件加载测试</h1>
        <p>此页面测试鸦片战争项目中CSS文件的加载状态。</p>
        
        <div class="test-item">
            <h3>测试 1: 检查.nojekyll文件</h3>
            <p id="test1-result">正在检查...</p>
            <button class="test-button" onclick="testNoJekyll()">运行测试</button>
        </div>
        
        <div class="test-item">
            <h3>测试 2: 检查main.css文件</h3>
            <p id="test2-result">正在检查...</p>
            <button class="test-button" onclick="testMainCSS()">运行测试</button>
        </div>
        
        <div class="test-item">
            <h3>测试 3: 检查timeline.css文件</h3>
            <p id="test3-result">正在检查...</p>
            <button class="test-button" onclick="testTimelineCSS()">运行测试</button>
        </div>
        
        <div class="test-item">
            <h3>测试 4: 检查CSS文件内容</h3>
            <p id="test4-result">点击按钮查看CSS文件内容预览</p>
            <button class="test-button" onclick="showCSSPreview()">显示CSS预览</button>
            <div id="css-preview" class="css-preview" style="display: none;">
                <!-- CSS预览内容将在这里显示 -->
            </div>
        </div>
        
        <div class="test-item">
            <h3>测试 5: 验证GitHub Pages兼容性</h3>
            <p id="test5-result">检查文件路径和引用是否正确</p>
            <button class="test-button" onclick="testGitHubPages()">运行测试</button>
        </div>
        
        <div class="test-item">
            <h3>修复总结</h3>
            <p>已完成的修复工作：</p>
            <ul>
                <li>✅ 创建了.nojekyll文件，确保GitHub Pages不使用Jekyll处理</li>
                <li>✅ 修复了main.css文件中的图片引用问题（替换为纯色渐变背景）</li>
                <li>✅ 修复了timeline.css文件中的图片引用问题（替换为纯色渐变背景）</li>
                <li>✅ 验证了HTML文件中的CSS引用路径正确</li>
                <li>✅ 测试了本地浏览器中的CSS加载</li>
            </ul>
            <p><strong>下一步：</strong>将修复后的文件推送到GitHub仓库，并重新部署GitHub Pages。</p>
        </div>
    </div>

    <script>
        function testNoJekyll() {
            fetch('.nojekyll')
                .then(response => {
                    if (response.ok) {
                        document.getElementById('test1-result').innerHTML = 
                            '<span class="success">✅ .nojekyll文件存在！GitHub Pages将正确提供CSS和JS文件。</span>';
                    } else {
                        document.getElementById('test1-result').innerHTML = 
                            '<span class="error">❌ .nojekyll文件不存在或无法访问。</span>';
                    }
                })
                .catch(error => {
                    document.getElementById('test1-result').innerHTML = 
                        '<span class="error">❌ 检查.nojekyll文件时出错：' + error + '</span>';
                });
        }
        
        function testMainCSS() {
            fetch('main.css')
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    } else {
                        throw new Error('HTTP状态码：' + response.status);
                    }
                })
                .then(cssText => {
                    // 检查是否包含修复后的渐变背景
                    if (cssText.includes('linear-gradient') && cssText.includes('#1e3a8a')) {
                        document.getElementById('test2-result').innerHTML = 
                            '<span class="success">✅ main.css文件加载成功！包含修复后的渐变背景。</span>';
                    } else {
                        document.getElementById('test2-result').innerHTML = 
                            '<span class="warning">⚠️ main.css文件加载成功，但可能未包含修复后的样式。</span>';
                    }
                })
                .catch(error => {
                    document.getElementById('test2-result').innerHTML = 
                        '<span class="error">❌ main.css文件加载失败：' + error + '</span>';
                });
        }
        
        function testTimelineCSS() {
            fetch('timeline.css')
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    } else {
                        throw new Error('HTTP状态码：' + response.status);
                    }
                })
                .then(cssText => {
                    // 检查是否包含修复后的渐变背景
                    if (cssText.includes('linear-gradient') && cssText.includes('rgba(30, 58, 138')) {
                        document.getElementById('test3-result').innerHTML = 
                            '<span class="success">✅ timeline.css文件加载成功！包含修复后的渐变背景。</span>';
                    } else {
                        document.getElementById('test3-result').innerHTML = 
                            '<span class="warning">⚠️ timeline.css文件加载成功，但可能未包含修复后的样式。</span>';
                    }
                })
                .catch(error => {
                    document.getElementById('test3-result').innerHTML = 
                        '<span class="error">❌ timeline.css文件加载失败：' + error + '</span>';
                });
        }
        
        function showCSSPreview() {
            fetch('main.css')
                .then(response => response.text())
                .then(cssText => {
                    // 提取前200个字符作为预览
                    const preview = cssText.substring(0, 500) + '...';
                    document.getElementById('css-preview').innerHTML = preview;
                    document.getElementById('css-preview').style.display = 'block';
                    document.getElementById('test4-result').innerHTML = 
                        '<span class="success">✅ CSS文件内容预览已显示（前500字符）</span>';
                })
                .catch(error => {
                    document.getElementById('test4-result').innerHTML = 
                        '<span class="error">❌ 无法获取CSS文件内容：' + error + '</span>';
                });
        }
        
        function testGitHubPages() {
            // 检查相对路径是否正确
            const issues = [];
            
            // 检查CSS文件路径
            if (!document.querySelector('link[href="main.css"]')) {
                issues.push('index.html中缺少对main.css的引用');
            }
            
            // 检查.nojekyll文件
            fetch('.nojekyll')
                .then(response => {
                    if (!response.ok) {
                        issues.push('.nojekyll文件不存在');
                    }
                })
                .catch(() => {
                    issues.push('.nojekyll文件无法访问');
                });
            
            // 显示结果
            setTimeout(() => {
                if (issues.length === 0) {
                    document.getElementById('test5-result').innerHTML = 
                        '<span class="success">✅ 所有GitHub Pages兼容性检查通过！</span>';
                } else {
                    document.getElementById('test5-result').innerHTML = 
                        '<span class="error">❌ 发现以下问题：<br>' + issues.join('<br>') + '</span>';
                }
            }, 500);
        }
        
        // 页面加载时自动运行基本测试
        window.onload = function() {
            testNoJekyll();
            testMainCSS();
            testTimelineCSS();
        };
    </script>
</body>
</html>
